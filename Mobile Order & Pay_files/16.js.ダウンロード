(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{570:function(e,t,a){"use strict";var o=a(0);function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e}).apply(this,arguments)}var n=o.createElement("path",{d:"M9.051.449l7.66 14.16a.8.8 0 01-.662 1.2H.753a.8.8 0 01-.652-1.22L7.745.457A.7.7 0 019.052.449zm-1.65 5.86v3.2a1.005 1.005 0 002 0v-3.2a1.005 1.005 0 00-2 0zm0 6.1a1 1 0 101-1 1 1 0 00-1 1z",fill:"currentColor"});t.a=function(e){return o.createElement("svg",r({viewBox:"0 0 16.807 15.814"},e),n)}},618:function(e,t,a){"use strict";var o=a(0),r=a.n(o),n=a(13),c=a(38),s=a(2),l=a(44),i=a(4),u=a(81),d=a(153),m=a(154),f=a(151),b=a(570),p=a(7),v=a(14),E=function(e){var t,a,o=Object(n.useTranslation)(["common","mop"]).t;return r.a.createElement("div",{className:"card card-horizontal"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"d-flex f-space-between card-title mb-1"},e.data.storeName,r.a.createElement("div",{className:"d-flex ml-2 f-start-y"},e.showIconFavorite&&r.a.createElement("button",{className:"mr-2 d-flex",onClick:function(){e.handleFavoriteStore(e.data.storeCode,e.isFavorite)}},e.isFavorite?r.a.createElement(m.a,null):r.a.createElement(d.a,null)),r.a.createElement("a",{href:""+s.j.storeDetail+e.data.storeCode+"/"+Object(i.E)({mode:p.a.urlMode}),target:"_blank"},r.a.createElement("span",{className:"icon ml-2 txt-xs"},r.a.createElement(f.a,null))))),r.a.createElement("p",{className:"card-text py-2"},e.data.storeLocation.state+" "+e.data.storeLocation.city+" "+e.data.storeLocation.address1+" "+e.data.storeLocation.address2),r.a.createElement("p",{className:"d-flex f-center-y txt-xs py-2 "+(e.data.mopEnabled&&!e.data.unavailableStore?"":"txt-error")},(!e.data.mopEnabled||e.data.unavailableStore)&&r.a.createElement("span",{className:"icon txt-error mr-2"},r.a.createElement(b.a,null)),e.data.unavailableStore?o("mop:product_first.not_available"):e.data.readyForPickupInfo),e.data.mopEnabled&&r.a.createElement("span",{className:"card-text"},o("mop:stores.reception_end_time",{mopCloseAt:null===(t=e.data.mopCloseAt)||void 0===t?void 0:t.substring(0,null===(a=e.data.mopCloseAt)||void 0===a?void 0:a.lastIndexOf(":"))})),r.a.createElement("div",{className:"d-flex f-space-between f-center-y pt-2 mt-1"},r.a.createElement("span",{className:"card-text"},e.location?""+e.data.distance+o("common:km"):""),e.data.mopEnabled&&!e.data.unavailableStore?Object(u.a)(r.a.createElement("button",{className:"btn btn-flat-primary"},o("mop:select")))({storeData:e.data}):r.a.createElement("button",{className:"btn btn-flat-primary",disabled:!0},o("mop:select")))))},O=function(e){var t=e.mode,a=Object(n.useTranslation)("mop").t;return r.a.createElement("div",{className:"page-error mt-5"},r.a.createElement("div",{className:"txt-break-all"},"nearby"===t&&r.a.createElement("p",{className:"txt-lg"},a("mop:order.location_blocked")),"favorite"===t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"txt-md txt-prewrap txt-center px-3 mb-3 txt-bold"},a("mop:favorite_stores.no_store.title")),r.a.createElement("p",{className:"txt-md txt-prewrap txt-center px-3"},a("mop:favorite_stores.no_store.content")))))};t.a=function(e){var t,a=Object(n.useTranslation)("mop").t,u=Object(o.useState)([]),d=u[0],m=u[1],f=Object(v.useSelector)((function(e){return e.storesProduct.data})),b=Object(o.useRef)(null),p=Object(o.useState)(!0),h=p[0],j=p[1],g=Object(c.q)().setDialog,N=new l.a,S=location.search.includes("itemCode"),_=Object(o.useState)(JSON.parse(Object(i.r)(s.o.FAVORITE_STORES))),y=_[0],x=_[1];Object(o.useEffect)((function(){var t;if(S){var a=e.storesData;(null===(t=null==f?void 0:f.availableStores)||void 0===t?void 0:t.length)&&h&&(a=a.filter((function(e){var t;return!(!e.mopEnabled||!(null===(t=null==f?void 0:f.availableStores)||void 0===t?void 0:t.includes(e.storeCode)))}))),m(a.sort((function(e,t){return e.distance-t.distance})).slice(0,s.s))}}),[h]),Object(o.useEffect)((function(){(null==d?void 0:d.length)&&window.scrollTo(0,1)}),[d]),Object(o.useEffect)((function(){if(e.storesData){if(e.location&&"nearby"===e.mode&&!S&&(e.storesData.sort((function(e,t){return e.distance-t.distance})),m(e.storesData.slice(0,s.s))),"special"===e.mode){var t=e.storesData.filter((function(e){return+e.storeCode>=2381&&+e.storeCode<=2386}));m(t.sort((function(e,t){return+e.storeCode-+t.storeCode})))}if("favorite"===e.mode)if(y&&(null==y?void 0:y.length)){var a=[],o=[];null==y||y.forEach((function(t){var r=e.storesData.find((function(e){return e.storeCode===t}));r?a.push(r):o.push(t)})),m(a);var r=y.filter((function(e){return!o.includes(e)}));Object(i.I)(s.o.FAVORITE_STORES,r)}else m([])}return function(){window.history.replaceState({showSelectedStore:!0},"")}}),[e.storesData]);var w=function(t,a){"nearby"===e.mode&&N.addGa("favorite","list",t,a?"onoff":"offon"),"favorite"===e.mode&&N.addGa("favorite","bookmark",t,a?"onoff":"offon"),Object(i.v)(t,a)?x(JSON.parse(Object(i.r)(s.o.FAVORITE_STORES))):g({type:c.e.MESSAGE,data:{header:"favorite_stores.limitation.header",content:"favorite_stores.limitation.content"}})};return"nearby"!==e.mode||e.location?d.length||S?r.a.createElement("div",null,!!S&&(null===(t=null==f?void 0:f.availableStores)||void 0===t?void 0:t.length)>0&&r.a.createElement("div",{className:"pd-3 bg-white bd-b1 sticky-checkbox"},r.a.createElement(c.d,{register:b,name:"available-store",className:"available-store",default:!0,label:a("product_first.show_available_store"),onChange:function(){return N.addGa("productFirst","storeList","",h?"onoff":"offon"),void j(!h)}})),d.length?r.a.createElement("ul",{className:"list-group no-bd-bottom bg-white pt-2 "+(b.current?"has-checkbox":"")},d.map((function(t){return r.a.createElement("li",{className:"list-group-item",key:t.storeCode},r.a.createElement(E,{data:t,location:e.location,isFavorite:null==y?void 0:y.includes(t.storeCode),handleFavoriteStore:w,showIconFavorite:!S}))}))):r.a.createElement("div",{className:"page-error-store mt-5 f-center-y"},r.a.createElement("div",{className:"txt-break-all px-3"},r.a.createElement("h4",{className:"txt-md txt-prewrap txt-center mb-3 txt-bold"},a("product_first.no_stores.title")),r.a.createElement("p",{className:"txt-sm txt-prewrap"},a("product_first.no_stores.content")),r.a.createElement("div",{className:"mt-3"},r.a.createElement("p",{className:"txt-sm txt-prewrap"},a("product_first.no_stores.note_location")),r.a.createElement("p",{className:"txt-sm txt-prewrap"},a("product_first.no_stores.note_map")))))):r.a.createElement(O,{mode:e.mode}):r.a.createElement(O,{mode:"nearby"})}},855:function(e,t,a){"use strict";a.r(t);var o=a(0),r=a.n(o),n=a(14),c=a(10),s=a(13),l=a(618),i=a(38),u=function(e){var t=e.storesData,a=e.location,o=Object(s.useTranslation)("mop").t,n=Object(i.q)().setDialog;return r.a.createElement(r.a.Fragment,null,!a&&r.a.createElement("div",{className:"location-off"},r.a.createElement("button",{className:"btn btn-flat-gray txt-gray",onClick:function(){n({type:i.e.MESSAGE,className:"dialog-warning-location",data:{content:"choose_store.turn_of_location",close:"common.close"}})}},o("stores.location_off"))),r.a.createElement(i.l,{storesData:t,location:a}))},d=a(8),m=a(2),f=a(4),b=a(80),p=a(111),v=a(20),E=a(12),O=function(){return(O=Object.assign||function(e){for(var t,a=1,o=arguments.length;a<o;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},h=Object(p.c)((function(e){var t=e.listTabs,a=e.storesData,o=e.location;return r.a.createElement("div",{className:"page-content pt-5"},r.a.createElement(c.Switch,null,a&&(null==t?void 0:t.map((function(t,n){return r.a.createElement(c.Route,{exact:t.exact,path:t.pathName,key:n},r.a.createElement(t.component,O({storesData:a,location:o,mode:t.mode},e)))})))))}));t.default=Object(p.d)(Object(n.connect)((function(e){var t;return{isProcessing:e.cart.isProcessing,listStore:e.stores.data,loginUrl:null===(t=e.auth.data)||void 0===t?void 0:t.loginUrl,isLoading:e.stores.isLoading||e.storesProduct.isLoading,error:e.stores.error||e.storesProduct.error}}),(function(e){return{getStores:function(){return e(Object(d.I)())},clearCartError:function(){return e(Object(d.m)())},clearStoresByProduct:function(){return e(Object(d.v)())},clearStores:function(){return e(Object(d.u)())},getUrlLogin:function(t){return e(Object(E.o)(t))},getStoresByProduct:function(t){return e(Object(d.gb)(t))}}}))((function(e){var t=new v.a,a=Object(o.useState)(null),s=a[0],i=a[1],p=Object(n.useSelector)((function(e){return e.storesProduct.data})),E=Object(c.useRouteMatch)().path,O=Object(c.useLocation)(),j=JSON.parse(Object(f.r)(m.o.REMOVE_STORE_CODE)),g=Object(f.t)("itemCode"),N=Object(f.t)(m.q),S=location.search.includes("itemCode"),_=new URLSearchParams(Object(c.useLocation)().search);Object(f.H)(m.o.PRODUCT_FIRST_ERROR_401),Object(f.H)(m.o.CHOOSE_STORE_ERROR_401),Object(f.I)(m.o.MFL_FLAG,N);var y=Object(f.t)("ticket_kind_id"),x=Object(f.t)("serial_number"),w=Object(f.u)(m.r,_),k=JSON.parse(Object(f.r)(m.o.MFL_INFO)),C=JSON.parse(Object(f.r)(m.o.ETICKET_INFO));j&&(Object(f.H)(m.o.STORE_CODE),Object(f.H)(m.o.REMOVE_STORE_CODE));var T=[{exact:!0,pathName:E,component:u},{pathName:E+"/list",component:l.a,mode:"nearby"},{pathName:E+"/favorite",component:l.a,mode:"favorite"}];Object(o.useEffect)((function(){if(t.isAuthenticated())e.listStore||e.getStores();else{var a={pageRedirect:""+location.pathname+(g?"?itemCode="+g+(Object(f.y)(w)?"":Object(f.w)(w)):Object(f.x)(y,x))};e.getUrlLogin(a)}return function(){Object(d.m)(),e.clearStoresByProduct()}}),[]),Object(o.useEffect)((function(){e.loginUrl&&(location.href=e.loginUrl)}),[e.loginUrl]),Object(o.useEffect)((function(){!e.listStore||S&&!p||I(e.listStore)}),[e.listStore,p]),Object(o.useEffect)((function(){if(t.isAuthenticated()){if(Object(f.I)(m.o.TUTORIAL_VIEWED,!0),x&&y){k&&Object(f.H)(m.o.MFL_INFO);var a={ticketKindId:y,serialNumber:x};Object(f.I)(m.o.ETICKET_INFO,a),window.location.replace("/order/choose-store")}Object(f.y)(w)?Object(f.H)(m.o.MFL_INFO):(C&&Object(f.H)(m.o.ETICKET_INFO),Object(f.I)(m.o.MFL_INFO,w)),S&&e.getStoresByProduct(g)}return function(){e.clearStores()}}),[]);var F=Object(o.useCallback)((function(e){var t,a;return!!S&&((null==p?void 0:p.availableStores.length)?!(!e.mopEnabled||(null===(a=null==p?void 0:p.availableStores)||void 0===a?void 0:a.includes(e.storeCode))):null===(t=null==p?void 0:p.nonAvailableStores)||void 0===t?void 0:t.includes(e.storeCode))}),[p]),I=function(e){return function(e,t,a,o){return new(a||(a=Promise))((function(r,n){function c(e){try{l(o.next(e))}catch(e){n(e)}}function s(e){try{l(o.throw(e))}catch(e){n(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(c,s)}l((o=o.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function(){var t,a;return function(e,t){var a,o,r,n,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return n={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function s(n){return function(s){return function(n){if(a)throw new TypeError("Generator is already executing.");for(;c;)try{if(a=1,o&&(r=2&n[0]?o.return:n[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,n[1])).done)return r;switch(o=0,r&&(n=[2&n[0],r.value]),n[0]){case 0:case 1:r=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==n[0]&&2!==n[0])){c=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){c.label=n[1];break}if(6===n[0]&&c.label<r[1]){c.label=r[1],r=n;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(n);break}r[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{a=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}}(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,Object(b.e)()];case 1:return a=o.sent(),t=a.coords,[3,3];case 2:return o.sent(),t=null,[3,3];case 3:return e.map((function(e){e.distance=Object(b.d)(e.storeCoordinate,t||m.h),e.unavailableStore=F(e)})),i({listTabs:T,storesData:e,location:t}),[2]}}))}))};return r.a.createElement("div",{className:"page"+(O.pathname===E?" page-full":"")},r.a.createElement(h,{data:s,isLoading:e.isLoading||Object(f.y)(null==s?void 0:s.storesData),error:e.error}))})),{title:"page_title.mop.choose_store",useBack:!0,backTo:"/",useTabs:r.a.createElement((function(){var e=Object(s.useTranslation)("mop").t,t=location.search.includes("itemCode"),a=[{exact:!0,link:"/order/choose-store",title:e("stores.map")},{link:"/order/choose-store/list",title:e("stores.list_stores")},{link:"/order/choose-store/favorite",title:e("stores.favorite_stores"),hidden:t}];return r.a.createElement("div",{className:"tabs-group px-2"},r.a.createElement("ul",{className:"tabs-list"},a.map((function(e,t){var a=e.link,o=e.title,n=e.exact;return!e.hidden&&r.a.createElement("li",{key:t,className:"tabs-item mr-2"},r.a.createElement(c.NavLink,{exact:n,key:t,to:{pathname:a,search:window.location.search},activeClassName:"active",className:"tabs-link"},o))}))),!t&&r.a.createElement("span",{className:"tabs-item"},r.a.createElement(c.Link,{to:"/order/history",className:"txt-primary txt-link-effect mr-2"},e("order.history.title"))))}),null)})}}]);